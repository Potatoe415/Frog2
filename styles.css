/* Mobile-first, safe-area-aware styling with dvh fallback */
:root { --vh: 1vh; }
@supports (height: 1dvh) { :root { --vh: 1dvh; } }

:root {
  --board-size: min(92vw, calc(75 * var(--vh)));
  --cell: calc(var(--board-size) / 11);
  --gap: 0px;

  --bg: #0d0f14;
  --fg: #e8eefc;
  --pad: max(12px, env(safe-area-inset-left));
  --pad-r: max(12px, env(safe-area-inset-right));
  --pad-t: max(12px, env(safe-area-inset-top));
  --pad-b: max(12px, env(safe-area-inset-bottom));
}

* { box-sizing: border-box; }
html, body { height: 100%; background: var(--bg); color: var(--fg); }
body {
  margin: 0;
  font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
  overscroll-behavior: none;
}

.app {
  min-height: calc(100 * var(--vh));
  padding: calc(var(--pad-t)) var(--pad) calc(10px + var(--pad-b));
  display: grid;
  grid-template-rows: auto 1fr auto;
  gap: 10px;
}

.hud { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: 10px; user-select: none; }
.hud__left { text-align: left; }
.hud__center { text-align: center; }
.hud__right { text-align: right; }

.board-wrap {
  display: grid;
  place-items: center;
  touch-action: none;
  overscroll-behavior: contain;
  user-select: none;
  -webkit-user-select: none;
  -webkit-tap-highlight-color: transparent;
  position: relative;
}

.board {
  width: var(--board-size);
  height: var(--board-size);
  display: grid;
  grid-template-columns: repeat(11, 1fr);
  grid-template-rows: repeat(11, 1fr);
  gap: var(--gap);
  border-radius: 10px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.45);
  background: #0a0c12 url('Resources/board-bg.svg') center/cover no-repeat;
}

/* Cells */
.cell {
  width: 100%;
  height: 100%;
  position: relative;
  display: grid;
  place-items: center;
  font-size: calc(var(--cell) * 0.8);
  background-size: cover;
  background-position: center;
}

/* Terrain (images) */
.cell.grass { background-image: url('Resources/grass.svg'); }
.cell.road  { background-image: url('Resources/road.svg'); }
.cell.river { background-image: url('Resources/water.svg'); }
.cell.home  { background-image: url('Resources/home.svg'); }
.cell.home.home--filled { background-color: #3ea84a; }

/* Occupants */
.cell::after {
  content: "";
  position: absolute;
  inset: 8%;
  background-repeat: no-repeat;
  background-position: center;
  background-size: contain;
  pointer-events: none;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.35));
}
.cell.frog::after { background-image: url('Resources/frog.svg'); }
.cell.car::after  { background-image: url('Resources/car.svg'); }
.cell.log::after  { background-image: url('Resources/log.svg'); }

/* Overlay */
.overlay { position: absolute; inset: 0; display: grid; place-items: center; background: rgba(5,7,12,0.55); backdrop-filter: blur(2px); }
.overlay.hidden { display: none; }
.overlay__card {
  background: #141923;
  color: var(--fg);
  border-radius: 12px;
  padding: 18px 16px;
  width: min(92vw, 440px);
  box-shadow: 0 8px 28px rgba(0,0,0,0.6);
  text-align: center;
}
.overlay__buttons { display: flex; gap: 10px; justify-content: center; margin-top: 10px; }
.best, .hint { opacity: 0.85; margin: 8px 0 0; }

/* Buttons */
.btn { background: #2b61d1; color: white; border: none; border-radius: 10px; padding: 10px 14px; font-weight: 600; cursor: pointer; touch-action: manipulation; }
.btn:active { transform: translateY(1px); }
.btn.hidden { display: none; }
.btn--pause { position: absolute; top: 8px; right: 8px; z-index: 3; width: 40px; height: 32px; border-radius: 8px; background: rgba(255,255,255,0.08); color: #d9e2ff; font-weight: 700; line-height: 1; }

/* D-pad */
.dpad { display: none; margin-top: 10px; width: min(92vw, var(--board-size)); place-self: center; touch-action: manipulation; }
@media (pointer: coarse) {
  .dpad { display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(3, 1fr); gap: 10px; }
}
.dpad__btn {
  background: #22314f; color: #e9f1ff; border: 1px solid rgba(255,255,255,0.08);
  border-radius: 12px; width: 100%;
  height: clamp(56px, 6.5dvh, 72px);
  font-size: 22px; font-weight: 700; -webkit-tap-highlight-color: transparent;
}
.dpad__btn:active { background: #2a3d62; }
.dpad__btn--up   { grid-column: 2; grid-row: 1; }
.dpad__btn--left { grid-column: 1; grid-row: 2; }
.dpad__btn--right{ grid-column: 3; grid-row: 2; }
.dpad__btn--down { grid-column: 2; grid-row: 3; }

@media (pointer: fine) { .btn--pause { display: none; } }
